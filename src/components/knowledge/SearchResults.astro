---
// src/components/knowledge/SearchResults.astro
const { query } = Astro.props;

// Voorbeeld artikelen – vervang later door echte data
const articles = [
  { slug: "/kennisbank/verhuizing", title: "Gratis verhuisservice aanvragen", excerpt: "Wij verhuizen jouw website, e-mail en database gratis en zonder downtime naar GetHost." },
  { slug: "/kennisbank/geld-terug", title: "30 dagen geld-terug-garantie", excerpt: "Niet tevreden? Binnen 30 dagen krijg je jouw geld terug – zonder vragen." },
  { slug: "/kennisbank/inloggen", title: "Inloggen op mijn account", excerpt: "Stap-voor-stap uitleg inclusief wachtwoord vergeten en tweefactorauthenticatie." },
  { slug: "/kennisbank/ssl-activeren", title: "SSL certificaat activeren", excerpt: "Gratis Let's Encrypt SSL in één klik via DirectAdmin." },
  { slug: "/kennisbank/wordpress-installeren", title: "WordPress installeren", excerpt: "Installeer WordPress met één klik via Softaculous." },
  { slug: "/kennisbank/email-outlook", title: "E-mail instellen in Outlook", excerpt: "Volledige handleiding voor IMAP/POP3 instellingen." },
  { slug: "/kennisbank/factuur-betalen", title: "Factuur betalen", excerpt: "Betalen via iDEAL, PayPal, bankoverschrijving of automatische incasso." },
  { slug: "/kennisbank/vps-inloggen", title: "Inloggen op mijn VPS", excerpt: "SSH toegang instellen en eerste keer inloggen." },
  { slug: "/kennisbank/statuspagina", title: "Statuspagina controleren", excerpt: "Bekijk live status van alle systemen op gethost.statuspage.io" },
  { slug: "/kennisbank/directadmin", title: "Inloggen op DirectAdmin", excerpt: "Hoe log je in op jouw hosting control panel?" },
];

const filtered = query
  ? articles.filter(article =>
      article.title.toLowerCase().includes(query.toLowerCase()) ||
      article.excerpt.toLowerCase().includes(query.toLowerCase())
    )
  : [];
---

<div x-show="query.length > 1"
     x-transition:enter="transition ease-out duration-200"
     x-transition:enter-start="opacity-0 translate-y-4"
     x-transition:enter-end="opacity-100 translate-y-0"
     x-transition:leave="transition ease-in duration-150"
     x-transition:leave-start="opacity-100"
     x-transition:leave-end="opacity-0"
     class="absolute top-full left-0 right-0 mt-2 bg-white rounded-xl shadow-2xl border border-gray-200 overflow-hidden z-50 max-h-96 overflow-y-auto">

  <!-- Geen resultaten -->
  <template x-if="filtered.length === 0">
    <div class="p-8 text-center text-gray-500">
      Geen resultaten gevonden voor "<span x-text="query"></span>"
    </div>
  </template>

  <!-- Wel resultaten -->
  <template x-if="filtered.length > 0">
    <div>
      <!-- Toon max 8 resultaten -->
      <template x-for="article in filtered.slice(0, 8)" :key="article.slug">
        <a :href="article.slug" class="block p-5 hover:bg-gray-50 transition border-b border-gray-100 last:border-0">
          <h4 class="font-semibold text-dark mb-1" x-text="article.title"></h4>
          <p class="text-sm text-gray-600 line-clamp-2" x-text="article.excerpt"></p>
        </a>
      </template>

      <!-- Meer dan 8 resultaten? Toon knop -->
      <template x-if="filtered.length > 8">
        <div class="p-4 bg-gray-50 text-center border-t border-gray-200">
          <a :href="`/kennisbank?zoek=${query}`" class="text-primary font-medium hover:underline">
            Toon alle <span x-text="filtered.length"></span> resultaten →
          </a>
        </div>
      </template>
    </div>
  </template>
</div>